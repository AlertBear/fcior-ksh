#
# Copyright (c) 2009, 2011, Oracle and/or its affiliates. All rights reserved.
#

USB Video Test Suite README


DESCRIPTION
===========
This is the USB Video Class Test Suite designed to provide USB video
functional and interface tests.

PREREQUISITES
=============
1. A usb video device is required
2. The CTI-TET lite test harness is required.  This may be installed locally
   on  the system under test or available over NFS.
3. The system/header/header-usb package is required when building the test 
   suite from source. 
4. STC version 2.3 and later of this test suite requires at least snv_056 
   to be installed on the system under test in order to properly build and 
   execute all tests. 

CTI-TET INSTALLATION
====================
In the majority of cases, the CTI-TET lite test harness can be installed
from packages.  The package is called SUNWstc-tetlite and it installs to
/opt by default.  The installation is via the standard Solaris package
addition tool, pkgadd(1M).  To install SUNWstc-tetlite, do:

        root# pkgadd -d <package-location> SUNWstc-tetlite

where <package-location> is the path containing the SUNWstc-tetlite package
directory.  'root#' indicates that this command must be run as root.

It is recommended that SUNWstc-tetlite be installed from scratch, rather
than on top of an existing installation.  If a copy of SUNWstc-tetlite is
already installed on the system, remove it first:

        root# pkgrm SUNWstc-tetlite

An NFS accessible version of SUNWstc-tetlite may be used as an alternative
to installing the package locally.

HEADER-USB INSTALLATION
=======================
To build the USB video test suite from source, the system/header/header-usb
package is required, if you install the USB video test suite from
SUNWstc-video-usb package, system/header/header-usb is not a mandatory 
requirement.

Installation is via the Solaris image packaging retrieval client, pkg(1).
First, make sure the pkg publisher has been set correctly, do:
	$ pkg publisher
	
Then check whether the package has already been installed, do:
	$ pkg info system/header/header-usb

If the package has not been installed, do (as root):
	# pkg install system/header/header-usb


TEST SUITE INSTALLATION
=======================
In the majority of cases, the USB video test suite package can be intalled
locally on the system under test.  The test suite package is named 
SUNWstc-video-usb and it installs into /opt/ by default.  Installation is
via the standard Solaris package addition tool, pkgadd(1M).  To install the
package, do (as root):

	# pkgadd -d <package-location> SUNWstc-video-usb

where <package-location> is the path containing the SUNWstc-video-usb
package directory.

It is recommended that the test suite package be installed from scratch,
rather than on top of an existing installation.  If a copy of the test
suite package is already installed on the system, remove it first:

	# pkgrm SUNWstc-video-usb

The test suite can also be accessed via NFS over the network from a server.
Another alternative is to install the test suite source, and build the test
suite binaries.

Make sure the system/header/header-usb package has already been installed 
before build.

To build the test suite from source, install the source in some directory,
say "/export/STC/usr/closed/suites/video/usb", and then run the following
commands (the '$' prompt indicates that these commands need not be run as
root):

        $ CTI_ROOT=/opt/SUNWstc-tetlite/contrib/ctitools
        $ export CTI_ROOT
        $ PATH=$CTI_ROOT/bin:$PATH
        $ cd /export/STC/usr/closed/suites/video/usb
        $ /usr/ccs/bin/make install

When complete and successful, this command will install the test suite
binaries into a 'proto' directory under the workspace root directory.
In the example above, the workspace root directory is "/export/STC",
and the proto area "/export/STC/proto/suites/video/usb".

In addition, the test suite binary packages can be constructed using
the contents of the proto directory.  The build test suite packages, do:

        $ /usr/ccs/bin/make package

This can be done instead of, or in addition to, 'make install'.  The
packages thus constructed will be stored in the 'packages' directory
under the workspace root.


TEST SUITE CONFIGURATION
========================
Test suite configuration is required to be done as root.

1. Set environment variables

        export CTI_ROOT=/opt/SUNWstc-tetlite/contrib/ctitools
        export PATH=$PATH:$CTI_ROOT/bin

2. Configure the test suite

   Specify the execute loop and the usb video device name by editing the
   test_config file in the config directory under the test suite root


TEST SUITE EXECUTION
====================
Test suite execution is required to be done as root.

If you have not already set the environment, do the following:

        export CTI_ROOT=/opt/SUNWstc-tetlite/contrib/ctitools
        export PATH=$PATH:$CTI_ROOT/bin

Enter the test suite root directory (e.g., /opt/SUNWstc-video-usb,
or /export/STC/proto/suites/video/usb).

To run the entire test suite do the following.
        root# run_test usb

TEST SUITE UNCONFIGURE
======================
This test suite makes no unconfigurable system changes.
